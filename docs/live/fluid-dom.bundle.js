var fluid=function(t){"use strict";function e(t,e){var s="";for(var r of t){null!=e[r]||(s+=`Value for ${r} was not provided.\n`)}return!s||(console.error(`Expected ${t.length} parameters:\n${s}`),!1)}function s(t,e){var s=t.filter(t=>void 0===e[t]).length===t.length-1;if(s){var r=t.reduce((t,e)=>`${t}, ${e}`);console.error(`One of these parameters were expected ${r} but none had a hasValue!`)}return s}class r{constructor(t){this.domElement=t}each(t){for(var e of this.domElement.attributes)t(e.name,e.value);return this}attributeNames(){var t=new Array;for(var e of this.domElement.attributes)t.push(e);return t}add(t,e){return this.set(t,e)}set(t,e){return this.domElement.setAttribute(t,e),this}with(t,e){return e(this.get(t)),this}get(t){return this.domElement.getAttribute(t)}has(t){return null!=this.domElement.getAttribute(t)}remove(t){return this.domElement.removeAttribute(t),this}}class i{constructor(t,e){this.element=e,this.domElement=t}each(t){for(var e of this.domElement.classList)t(e);return this}has(t){return this.domElement.classList.contains(t)}whenHas(t,e){return this.has(t)&&e(this.element),this}add(t){return t&&t.length>0?this.domElement.classList.add(t):console.error(`Class name given was "${t}" - it must not be empty!`),this}remove(t){return this.domElement.classList.remove(t),this}set(t){return this.has(t)||this.add(t),this}}var n,o,l,h,a;!function(t){t.FailedToLocate="Failed to locate",t.Id="id",t.Selector="selector",t.Class="class",t.TagName="tagName",t.ConstructedWithElement="from given element",t.ConstructedWithChildren="from given list of children"}(n||(n={})),function(t){t.Button="BUTTON",t.Div="DIV",t.Input="INPUT",t.Paragraph="P"}(o||(o={}));class m{convertToListOfElements(t){var e=[];if(t)for(var s of t){var r=new d({domElement:s});e.push(r)}return e}constructor(t){var e=t.selector,r=t.tagName,i=t.children,o=t.class;this.elementListLocation=t,this.elementList=Array(),this.locatedBy=n.FailedToLocate,null!=e?this.selectList(e):r?this.tagList(r):i?this.childList(i):o?this.classList(o):(s(["selector","class","tagName"],t),this.elementList=[]),this.isSingle=!1,this.type="ElementList"}each(t){for(var e=0;e<this.elementList.length;e++)t(this.getElementAt(e));return this}getElementAt(t){return this.elementList[t]}map(t){return this.elementList.map(t)}filter(t){return this.elementList.filter(t)}reduce(t){return this.elementList.reduce(t)}length(){return this.elementList.length}selectList(t){this.elementList=this.convertToListOfElements(document.querySelectorAll(t)),this.locatedBy=n.Selector}tagList(t){this.elementList=this.convertToListOfElements(document.getElementsByTagName(t)),this.locatedBy=n.TagName}childList(t){this.elementList=this.convertToListOfElements(t),this.locatedBy=n.ConstructedWithChildren}classList(t){this.elementList=this.convertToListOfElements(document.getElementsByClassName(t)),this.locatedBy=n.Class}}class d{constructor(t){this.type="Element",this.isSingle=!0;var e,r=t.id,i=t.selector,o=t.domElement;this.locatedBy=n.FailedToLocate,this.isValid=!1,o?this.elementPassed(t):r?this.idPassed(r):i?this.selectorPassed(i):(s(["id","selector"],t),this.nullElement(t),this.isValid=!1),this.isValid||(e=`Element to be matched by ${this.locatedBy} was not valid`,console.warn("FluidDOM: "+e)),this.parent=this.isValid?this.domElement.parentElement:void 0,this.type="Element",this.elementLocation=t,this.isSingle=!0}elementPassed(t){this.domElement=t.domElement,this.locatedBy=n.ConstructedWithElement,this.isValid=!!this.domElement}idPassed(t){this.locatedBy=n.Id,this.domElement=document.getElementById(t),this.isValid=!!this.domElement}selectorPassed(t){this.domElement=document.querySelector(t),this.locatedBy=n.Selector,this.isValid=!!this.domElement}nullElement(t){this.domElement={tagName:`NO MATCH by ${t}`,parentElement:void 0,innerHTML:void 0,innerText:void 0},this.locatedBy=n.FailedToLocate}children(){return new m({children:this.domElement.children})}eachChild(t){for(var e of this.domElement.children){t(new d({domElement:e}))}return this}expect(t){return this.domElement.tagName!==t&&console.error(`Expected ${t} but Actual ${this.domElement.tagName}`),this}getId(){return this.attributes().get("id")}getParent(){return new d({domElement:this.domElement.parentElement})}hasId(){return this.attributes().has("id")}exists(){return this.isValid}findAll(t){return new m(t)}selectFirst(t){if(this.domElement.querySelector(t))return new d({selector:t});var e=`${this.selectorPath()}>${t}`;return new d({selector:e})}selectorPath(){for(var t=this.domElement,e=t=>!!t,s=[];e(t);){var r=t.getAttribute("id"),i=t.getAttribute("class");r?(s.push("#"+r),t=null):(i?s.push("."+i):s.push(t.tagName),t=t.parentElement)}return s.reverse(),s.reduce((t,e)=>`${t}>${e}`)}tagName(){return this.isValid?this.domElement.tagName:"UNKNOWN"}text(t){return t?(this.domElement.innerText=t,this):this.domElement.innerText}html(t){return t?(this.domElement.innerHTML=t,this):this.domElement.innerHTML}append(t){var e=`${this.html()}${t}`;return this.html(e),this}prepend(t){var e=`${t}${this.html()}`;return this.html(e),this}remove(){this.domElement.remove()}attributes(){return new r(this.domElement)}classes(){return new i(this.domElement,this)}on(t){if(e(["event","handler"],t)){var s=t.event,r=t.handler,i=t.keepDefault;this.domElement.addEventListener(s,function(t){i||t.preventDefault(),r(t)})}}value(){if(null!=this.domElement.value)return this.domElement.value}}(l=t.HttpMethod||(t.HttpMethod={})).CONNECT="CONNECT",l.DELETE="DELETE",l.GET="GET",l.HEAD="HEAD",l.OPTIONS="OPTIONS",l.PATCH="PATCH",l.POST="POST",l.PUT="PUT",l.TRACE="TRACE",(h=t.HttpResponseType||(t.HttpResponseType={})).TEXT="text",h.ARRAYBUFFER="arraybuffer",h.BLOB="blob",h.DOCUMENT="document",h.JSON="json",(a=t.HttpProtocol||(t.HttpProtocol={})).HTTP="http",a.HTTPS="https",a.FILE="file";class c{constructor(t){this.httpObject=t,this.promise=void 0}createPromise(t){this.result=void 0,this.promise=new Promise((e,s)=>{let r=this;t(function(t){r.result=t,e(t)},s)})}isResolved(){return null!=this.result}http(){return this.httpObject}afterResult(t){return this.hasPromise(this.promise)&&this.promise.then(e=>{t(this.httpObject,e)}),this}then(t){return this.hasPromise(this.promise)?this.next(this.promise.then(t)):this}catch(t){return this.hasPromise(this.promise)?this.next(this.promise.catch(t)):this}hasPromise(t){return this.promise instanceof Promise}next(t){let e=new c(this.httpObject);return e.promise=t,e}}class u{constructor(){this.protocol=t.HttpProtocol.HTTP,this.port=void 0,this.hostname="",this.requestHeaders=[],this.path="",this.method=t.HttpMethod.GET,this.body=void 0,this.uploadData=void 0,this.responseType=t.HttpResponseType.TEXT,this.timeoutMS=1e3}host(t,e,s){return this.hostname=e,this.port=s,this.protocol=t,this}header(t,e){return this.requestHeaders.push({name:t,value:e}),this}expectedData(t){return this.responseType=t,this}timeoutAt(t){return this.timeoutMS=t,this}context(t){let e=new u;return e.protocol=this.protocol,e.port=this.port,e.hostname=this.hostname,e.requestHeaders=(new Array).concat(this.requestHeaders),e.path=this.path,e.method=this.method,e.body=this.body,e.uploadData=this.uploadData,e.responseType=this.responseType,t(e),this}call(t,e,s){this.method=t,this.path=e,this.body="string"==typeof s?s:JSON.stringify(s),this.syncPortAndProtocol();let r=this.port?`:${this.port}`:"",i=`${this.protocol}://${this.hostname}${r}${e}`,n=this.createRequestTo(i),o=this.setHandlers(n);return this.addAnyHeaders(n),n.send(this.body),o}syncPortAndProtocol(){(this.protocol==t.HttpProtocol.HTTP&&80==this.port||this.protocol==t.HttpProtocol.HTTPS&&443==this.port||this.protocol==t.HttpProtocol.FILE)&&(this.port=void 0)}createRequestTo(t){let e=new XMLHttpRequest;return e.timeout=this.timeoutMS,e.open(this.method,t),e}setErrorHandlers(t,e){t.onabort=(()=>{e("Request Aborted")}),t.ontimeout=(()=>{e("Timed out")}),t.onerror=(()=>{e("Error occurred.")})}createResponseObject(t){let e=t.getAllResponseHeaders().split("\r\n").map(t=>{let e=t.split(":");return e&&2==e.length?{name:e[0],value:e[1]}:void 0}).filter(t=>null!=t),s={};for(var r in e){let t=e[r];t&&(s[t.name]=t.value)}return{status:t.status,type:t.responseType,body:t.response,headers:s}}setOnCompleteHandler(t,e,s){t.onreadystatechange=(()=>{4==t.readyState&&(200==t.status?e(this.createResponseObject(t)):s(`Returned HTTP ${t.status}`))})}addAnyHeaders(t){if(this.requestHeaders.length>0)for(var e of this.requestHeaders)t.setRequestHeader(e.name,e.value)}setHandlers(t){let e=new c(this);return e.createPromise((e,s)=>{this.setErrorHandlers(t,s),this.setOnCompleteHandler(t,e,s)}),e}}const p=["abort","afterscriptexecute","animationcancel","animationend","animationiteration","auxclick","beforescriptexecute","blur","change","click","close","contextmenu","dblclick","error","focus","fullscreenchange","fullscreenerror","gotpointercapture","input","keydown","keypress","keyup","load","loadend","loadstart","lostpointercapture","mousedown","mousemove","mouseout","mouseover","mouseup","offline","online","pointercancel","pointerdown","pointerenter","pointerleave","pointermove","pointerout","pointerover","pointerup","reset","resize","scroll","select","selectionchange","selectionchange","selectstart","submit","touchcancel","touchmove","touchstart","transitioncancel","transitionend","visibilitychange","wheel"];const E={};for(var v of p)E[v.toUpperCase()]=v;return t.DOM=class{constructor(){this.events=function(){var t={};for(var e of p)t[e.toUpperCase()]=e;return t}()}findElement(t){return new d(t)}findAll(t){return new m(t)}buttonOn(t){if(e(["id","event","handler"],t)){var s=t.id;this.findElement({id:s}).expect(o.Button).on(t)}}},t.Events=E,t.Http=u,t}({});
