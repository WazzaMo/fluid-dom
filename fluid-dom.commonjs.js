//  Fluid-DOM v 1.2.0
"use strict";function providesAll(t,e){var r="";for(var s of t){null!=e[s]||(r+=`Value for ${s} was not provided.\n`)}return!r||(console.error(`Expected ${t.length} parameters:\n${r}`),!1)}Object.defineProperty(exports,"__esModule",{value:!0});class Option{constructor(t){this.value=t||null}get Value(){return this.value}get isValid(){return!!this.value}}class DomAttributes{constructor(t){this._webElement=t}forEach(t){for(var e of this._webElement.attributes)t(e.name,e.value);return this}attributeNames(){var t=new Array;for(var e of this._webElement.attributes)t.push(e.name);return t}add(t,e){return this.set(t,e)}set(t,e){return this._webElement.setAttribute(t,e),this}with(t,e){return e(this.get(t)),this}get(t){return this._webElement.getAttribute(t)}has(t){return null!=this._webElement.getAttribute(t)}remove(t){return this._webElement.removeAttribute(t),this}}class DomClasses{constructor(t,e){this.element=e,this.htmlElement=t}forEach(t){for(var e of this.htmlElement.classList)t(e);return this}has(t){return this.htmlElement.classList.contains(t)}whenHas(t,e){return this.has(t)&&e(this.element),this}add(t){if(t&&t.length>0){if(!this.htmlElement)throw Error("Can't edit classes on DomElement that provides no HTMLElement.");this.htmlElement.classList.add(t)}else console.error(`Class name given was "${t}" - it must not be empty!`);return this}remove(t){return this.htmlElement.classList.remove(t),this}set(t){return this.has(t)||this.add(t),this}}class NonClasses{constructor(){}forEach(t){return this}has(t){return!1}whenHas(t,e){return this}add(t){return this}remove(t){return this}set(t){return this}}class NonAttributes{constructor(){}forEach(t){return this}attributeNames(){return[]}add(t,e){return this}set(t,e){return this}with(t,e){return this}get(t){return null}has(t){return!1}remove(t){return this}}class NonElement{constructor(){}isValid(){return!1}getParent(){return this}withChildren(t){return this}expect(t){return this}getId(){return null}hasId(){return!1}exists(){return!1}findAll(t){return[]}selectFirst(t){return this}selectorPath(){return""}tagName(){return""}text(t){return t?this:""}html(t){return t?this:""}append(t){return this}prepend(t){return this}remove(){}attributes(){return new NonAttributes}classes(){return new NonClasses}on(t){}value(){}}function convertHtmlCollection(t){let e=[];for(var r=0;r<t.length;r++){let s=t[r];e.push(new DomElement(s))}return e}function selectorPath(t){let e="";if(t){e=t.getAttribute("id")?"#{$id}":t.parentElement?`${selectorPath(t.parentElement)}>${t.tagName}`:t.tagName}return e}function getBySelector(t,e){let r=t.querySelector(e);return r||((r=document.querySelector(`${selectorPath(t)}>${e}`))?r:null)}class DomElement{constructor(t){this.domElement=new Option(t)}alertInvalid(){console.error("IElement[DomElement] is invalid.")}static getListFromSelector(t){return convertHtmlCollection(document.querySelectorAll(t))}static getListFromClass(t){return convertHtmlCollection(document.querySelectorAll(`.${t}`))}static getListFromTagName(t){return convertHtmlCollection(document.querySelectorAll(t))}static getElementFromId(t){let e=document.querySelector(`#${t}`);return DomElement.makeFromElement(e)}static getElementFromSelector(t){let e=document.querySelector(t);return DomElement.makeFromElement(e)}static makeFromElement(t){return t?new DomElement(t):new NonElement}isValid(){return this.domElement.isValid}getParent(){if(this.domElement.isValid){let t,e=this.domElement.Value.parentElement;return t=e?new DomElement(e):new DomElement}return new NonElement}withChildren(t){if(this.domElement.isValid&&this.domElement.Value.children.length>0){t(convertHtmlCollection(this.domElement.Value.children))}return this}expect(t){if(this.domElement.isValid){let e=this.domElement.Value.tagName.toUpperCase(),r=t.toUpperCase();e!=r&&console.error(`Expected ${r} but Actual tagName was ${e}`)}else this.alertInvalid();return this}getId(){return this.attributes().get("id")}hasId(){return this.attributes().has("id")}exists(){return this.isValid()}findAll(t){let e=t.selector||t.tagName;if(e){return convertHtmlCollection(this.domElement.Value.querySelectorAll(e))}return[]}selectFirst(t){if(this.domElement.isValid){let e=getBySelector(this.domElement.Value,t);if(e)return new DomElement(e)}return new DomElement}selectorPath(){return this.domElement.isValid?selectorPath(this.domElement.Value):(this.alertInvalid(),"")}tagName(){return this.domElement.isValid?this.domElement.Value.tagName:(this.alertInvalid(),"UNKNOWN")}text(t){if(this.domElement.isValid){let e=this.domElement.Value;return t?(e.innerText=t,this):e.innerText}return this.alertInvalid(),""}html(t){if(this.domElement.isValid){let e=this.domElement.Value;return t?(e.innerHTML=t,this):e.innerHTML}return this.alertInvalid(),""}append(t){var e=`${this.html()}${t}`;return this.html(e),this}prepend(t){var e=`${t}${this.html()}`;return this.html(e),this}remove(){this.domElement.isValid?this.domElement.Value.remove():this.alertInvalid()}attributes(){return this.domElement.isValid?new DomAttributes(this.domElement.Value):new NonAttributes}classes(){return this.domElement.isValid?new DomClasses(this.domElement.Value,this):new NonClasses}on(t){if(providesAll(["event","handler"],t)&&this.domElement.isValid){var e=t.event,r=t.handler,s=t.keepDefault;this.domElement.Value.addEventListener(e,function(t){s||t.preventDefault(),r(t)})}}value(){if(this.domElement.isValid){let t=this.domElement.Value;if(t.value)return t.value}}}var SourceType,Tag;!function(t){t.FailedToLocate="Failed to locate",t.Id="id",t.Selector="selector",t.Class="class",t.TagName="tagName",t.ConstructedWithElement="from given element",t.ConstructedWithChildren="from given list of children",t.Mock="Mock"}(SourceType||(SourceType={})),function(t){t.Button="BUTTON",t.Div="DIV",t.Input="INPUT",t.Paragraph="P"}(Tag||(Tag={})),function(t){t.CONNECT="CONNECT",t.DELETE="DELETE",t.GET="GET",t.HEAD="HEAD",t.OPTIONS="OPTIONS",t.PATCH="PATCH",t.POST="POST",t.PUT="PUT",t.TRACE="TRACE"}(exports.HttpMethod||(exports.HttpMethod={})),function(t){t.TEXT="text",t.ARRAYBUFFER="arraybuffer",t.BLOB="blob",t.DOCUMENT="document",t.JSON="json"}(exports.HttpResponseType||(exports.HttpResponseType={})),function(t){t.HTTP="http",t.HTTPS="https",t.FILE="file"}(exports.HttpProtocol||(exports.HttpProtocol={}));class HttpPromise{constructor(t){this.httpObject=t,this.promise=void 0}createPromise(t){this.result=void 0,this.promise=new Promise((e,r)=>{let s=this;t(function(t){s.result=t,e(t)},r)})}isResolved(){return null!=this.result}http(){return this.httpObject}afterResult(t){return this.hasPromise(this.promise)&&this.promise.then(e=>{t(this.httpObject,e)}),this}then(t){return this.hasPromise(this.promise)?this.next(this.promise.then(t)):this}catch(t){return this.hasPromise(this.promise)?this.next(this.promise.catch(t)):this}hasPromise(t){return this.promise instanceof Promise}next(t){let e=new HttpPromise(this.httpObject);return e.promise=t,e}}class Http{constructor(){this.protocol=exports.HttpProtocol.HTTP,this.port=void 0,this.hostname="",this.requestHeaders=[],this.path="",this.method=exports.HttpMethod.GET,this.body=void 0,this.uploadData=void 0,this.responseType=exports.HttpResponseType.TEXT,this.timeoutMS=1e3}host(t,e,r){return this.hostname=e,this.port=r,this.protocol=t,this}header(t,e){return this.requestHeaders.push({name:t,value:e}),this}expectedData(t){return this.responseType=t,this}timeoutAt(t){return this.timeoutMS=t,this}context(t){let e=new Http;return e.protocol=this.protocol,e.port=this.port,e.hostname=this.hostname,e.requestHeaders=(new Array).concat(this.requestHeaders),e.path=this.path,e.method=this.method,e.body=this.body,e.uploadData=this.uploadData,e.responseType=this.responseType,t(e),this}call(t,e,r){this.method=t,this.path=e,this.body="string"==typeof r?r:JSON.stringify(r),this.syncPortAndProtocol();let s=this.port?`:${this.port}`:"",n=`${this.protocol}://${this.hostname}${s}${e}`,o=this.createRequestTo(n),i=this.setHandlers(o);return this.addAnyHeaders(o),o.send(this.body),i}syncPortAndProtocol(){(this.protocol==exports.HttpProtocol.HTTP&&80==this.port||this.protocol==exports.HttpProtocol.HTTPS&&443==this.port||this.protocol==exports.HttpProtocol.FILE)&&(this.port=void 0)}createRequestTo(t){let e=new XMLHttpRequest;return e.timeout=this.timeoutMS,e.open(this.method,t),e}setErrorHandlers(t,e){t.onabort=(()=>{e("Request Aborted")}),t.ontimeout=(()=>{e("Timed out")}),t.onerror=(()=>{e("Error occurred.")})}createResponseObject(t){let e=t.getAllResponseHeaders().split("\r\n").map(t=>{let e=t.split(":");return e&&2==e.length?{name:e[0],value:e[1]}:void 0}).filter(t=>null!=t),r={};for(var s in e){let t=e[s];t&&(r[t.name]=t.value)}return{status:t.status,type:t.responseType,body:t.response,headers:r}}setOnCompleteHandler(t,e,r){t.onreadystatechange=(()=>{4==t.readyState&&(200==t.status?e(this.createResponseObject(t)):r(`Returned HTTP ${t.status}`))})}addAnyHeaders(t){if(this.requestHeaders.length>0)for(var e of this.requestHeaders)t.setRequestHeader(e.name,e.value)}setHandlers(t){let e=new HttpPromise(this);return e.createPromise((e,r)=>{this.setErrorHandlers(t,r),this.setOnCompleteHandler(t,e,r)}),e}}const EVENT_LIST=["abort","afterscriptexecute","animationcancel","animationend","animationiteration","auxclick","beforescriptexecute","blur","change","click","close","contextmenu","dblclick","error","focus","fullscreenchange","fullscreenerror","gotpointercapture","input","keydown","keypress","keyup","load","loadend","loadstart","lostpointercapture","mousedown","mousemove","mouseout","mouseover","mouseup","offline","online","pointercancel","pointerdown","pointerenter","pointerleave","pointermove","pointerout","pointerover","pointerup","reset","resize","scroll","select","selectionchange","selectionchange","selectstart","submit","touchcancel","touchmove","touchstart","transitioncancel","transitionend","visibilitychange","wheel"];function createEventHash(){var t={};for(var e of EVENT_LIST){t[e.toUpperCase()]=e}return t}class DOM{constructor(){this.events=createEventHash()}findElement(t){let e=t.id;if(e)return DomElement.getElementFromId(e);let r=t.selector;return r?DomElement.getElementFromSelector(r):new NonElement}findAll(t){let e=t.selector;if(e)return DomElement.getListFromSelector(e);let r=t.class;if(r)return DomElement.getListFromClass(r);let s=t.tagName;return s?DomElement.getListFromTagName(s):[]}buttonOn(t){if(providesAll(["id","event","handler"],t)){var e=t.id;this.findElement({id:e}).expect(Tag.Button).on(t)}}}const Events={};for(var event of EVENT_LIST)Events[event.toUpperCase()]=event;exports.DOM=DOM,exports.Events=Events,exports.Http=Http;

